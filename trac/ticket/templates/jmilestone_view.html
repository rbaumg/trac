{# Copyright (C) 2006-2014 Edgewall Software

  This software is licensed as described in the file COPYING, which
  you should have received as part of this distribution. The terms
  are also available at http://trac.edgewall.com/license.html.

  This software consists of voluntary contributions made by many
  individuals. For the exact contribution history, see the revision
  history and logs, available at http://trac.edgewall.org/.
#}
# extends "jlayout.html"
<!DOCTYPE html>
<html>
  <head>
    <title>
      # block title
      ${_("Milestone %(name)s", name=milestone.name)}
      ${ super() }
      # endblock title
    </title>
    # block head
    ${ super() }
    #   if 'MILESTONE_MODIFY' in perm(milestone.resource):
    <link rel="alternate" type="application/x-wiki"
          title="${_("Edit this milestone")}"
          href="${href.milestone(milestone.name, action='edit')}" />
    #   endif
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("#content").find("h1,h2,h3,h4,h5,h6").addAnchor("Link to this section");
        $(".foldable").enableFolding(true, true);
      });
    </script>
    # endblock head
  </head>

  <body>
    # block content
    <div id="content" class="milestone">
      <h1>${_("Milestone %(name)s", name=milestone.name)}</h1>
      <div class="info trac-progress">
        <p class="date">
          # if milestone.completed:
          ${_("Completed %(duration)s ago (%(date)s)",
              duration=dateinfo(milestone.completed),
              date=format_datetime(milestone.completed))}
          # elif milestone.is_late:
          #   trans duration = dateinfo(milestone.due), date = format_datetime(milestone.due)

          <strong>${duration} late</strong> (${date})

          #   endtrans
          # elif milestone.due:
          ${_("Due in %(duration)s (%(date)s)",
              duration=dateinfo(milestone.due),
              date=format_datetime(milestone.due))}
          # else:
          ${_("No date set")}
          # endif
          </p>
        # include "jprogress_bar.html" if stats.count ignore missing
      </div>

      # if available_groups and stats.count:
      <form id="stats" class="trac-groupprogress" action="">
        <fieldset>
          <legend>
            <label for="by">${_("%(stat_title)s by",
                                stat_title=stats.title.capitalize())}</label>
            <select id="by" name="by" onchange="this.form.submit()">
              # for group in available_groups:
              <option${{'value': group.name,
                        'selected': grouped_by == group.name
                       }|htmlattr}>${group.label}</option>
              # endfor
            </select>
            <input type="submit" value="${_('Update')}" class="noscript"/>
            <script type="text/javascript">
              jQuery(document).ready(function ($) {
                $(".noscript").attr("style", "display: none");
              });
            </script>
          </legend>
          # with summary = _('Shows the milestone completion status grouped by %(grouped_by)s', grouped_by=grouped_by)
          #   include "jprogress_bar_grouped.html" if groups ignore missing
          # endwith
        </fieldset>
      </form>
      # endif

      # if milestone.description:
      <div class="description trac-content">
        ${wiki_to_html(context, milestone.description)}
      </div>
      # endif

      # with alist = attachments, compact = true, foldable = true
      #   include "jlist_of_attachments.html"
      # endwith

      # set can_modify = 'MILESTONE_MODIFY' in perm(milestone.resource)
      # set can_delete = 'MILESTONE_DELETE' in perm(milestone.resource)
      # if can_modify or can_delete or attachments.can_create:
      <div class="buttons">
        # if can_modify:
        <form method="get" action="" id="editmilestone">
          <div>
            <input type="hidden" name="action" value="edit" />
            <input type="submit" value="${_('Edit milestone')}" acceptkey="e" />
          </div>
        </form>
        # endif
        # if can_delete:
        <form method="get" action="" id="deletemilestone">
          <div>
            <input type="hidden" name="action" value="delete" />
            <input type="submit" value="${_('Delete milestone')}" />
          </div>
        </form>
        # endif
        # with alist = attachments
        #   include "jattach_file_form.html"
        # endwith
      </div>
      # endif

      <div id="help">
        # trans href = href.wiki('TracRoadmap')

        <strong>Note:</strong> See <a href="${href}">TracRoadmap</a>
        for help on using the roadmap.

        # endtrans
      </div>

    </div>
    ${ super() }
    # endblock content
  </body>
</html>
